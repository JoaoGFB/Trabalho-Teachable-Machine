<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Apresenta√ß√£o com Reconhecimento por Imagem</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: white;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input[type="file"] {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      background: lightgrey;
      color: black;
      font-size: 16px;
      cursor: pointer;
      margin-bottom: 20px;
    }
    #startButton {
      padding: 15px 30px;
      border: none;
      border-radius: 8px;
      background: #4CAF50;
      color: white;
      font-size: 18px;
      cursor: pointer;
      margin: 10px;
      transition: background 0.3s;
    }
    #stopButton {
      padding: 15px 30px;
      border: none;
      border-radius: 8px;
      background: #dc3545;
      color: white;
      font-size: 18px;
      cursor: pointer;
      margin: 10px;
      transition: background 0.3s;
    }
    #fullscreenButton {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: #007bff;
      color: white;
      font-size: 14px;
      cursor: pointer;
      margin: 5px;
    }
    #startButton:hover {
      background: #45a049;
    }
    #stopButton:hover {
      background: #c82333;
    }
    #startButton:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
    canvas {
      display: block;
      margin: auto;
      max-width: 100%;
      max-height: 100%;
    }
    .status {
      margin-top: 10px;
      color: #666;
      font-size: 14px;
      text-align: center;
    }
    .loading {
      color: #007bff;
    }
    .error {
      color: #dc3545;
    }
    .success {
      color: #28a745;
    }
    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    #webcam-container {
      margin: 20px 0;
      border: 2px solid #007bff;
      border-radius: 8px;
      padding: 10px;
    }
    #label-container {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 12px;
      border-radius: 8px;
      font-family: sans-serif;
      font-size: 16px;
      z-index: 1000;
    }
  </style>
</head>

<body>
  <input type="file" id="fileInput" accept="application/pdf">
  
  <div class="button-container">
    <button id="startButton" onclick="initImageControl()">üì∑ Ativar Reconhecimento por Imagem</button>
    <button id="stopButton" onclick="stopImageControl()" style="display:none;">‚èπÔ∏è Parar Reconhecimento</button>
    <button id="fullscreenButton" onclick="activateFullscreen()">üì∫ Tela Cheia</button>
  </div>
  
  <div id="webcam-container"></div>
  <div id="statusMessage" class="status loading">Carregando bibliotecas...</div>
  <canvas id="pdf-render" style="display:none;"></canvas>
  
  <div id="label-container">Aguardando inicializa√ß√£o...</div>

  
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>

  <!-- Teachable Machine Image -->
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
  
  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js";
  </script>

  <!-- Seus scripts -->
  <script src="pdf.js"></script>
  <script src="image.js"></script> <!-- Mudei de voice.js para image.js -->

  <script>
    // Verifica quando as bibliotecas est√£o carregadas
    document.addEventListener('DOMContentLoaded', function() {
      const statusDiv = document.getElementById('statusMessage');
      const startButton = document.getElementById('startButton');
      const stopButton = document.getElementById('stopButton');
      const fullscreenButton = document.getElementById('fullscreenButton');
      
      function checkLibraries() {
        // Verifica se TensorFlow.js est√° carregado
        if (typeof tf === 'undefined') {
          statusDiv.textContent = 'Aguardando TensorFlow.js...';
          return;
        }
        
        // Verifica se Teachable Machine Image est√° carregado
        if (typeof tmImage === 'undefined') {
          statusDiv.textContent = 'Aguardando Teachable Machine Image...';
          return;
        }
        
        // Verifica se PDF.js est√° carregado
        if (typeof pdfjsLib === 'undefined') {
          statusDiv.textContent = 'Aguardando PDF.js...';
          return;
        }
        
        // Todas as bibliotecas carregadas
        statusDiv.textContent = 'Pronto! Clique para ativar o reconhecimento por imagem.';
        statusDiv.className = 'status success';
        startButton.disabled = false;
        stopButton.style.display = 'block';
        fullscreenButton.style.display = 'block';
      }
      
      // Verifica a cada segundo
      const checkInterval = setInterval(checkLibraries, 1000);
      
      // Para de verificar ap√≥s 10 segundos
      setTimeout(() => {
        clearInterval(checkInterval);
        if (startButton.disabled) {
          statusDiv.textContent = 'Timeout: Recarregue a p√°gina ou verifique a conex√£o.';
          statusDiv.className = 'status error';
        }
      }, 10000);
      
      // Primeira verifica√ß√£o ap√≥s 2 segundos
      setTimeout(checkLibraries, 2000);
    });
  </script>
</body>
</html>